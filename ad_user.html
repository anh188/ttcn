<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quản lý thông tin hoa</title>
    <link rel="stylesheet" href="./css/admin.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="stylesheet" href="./css/menu_ad.css">
    <link rel="stylesheet" href="./css/ad_user.css">
  </head>
<body>
  <div class="management">
    <div class="management_lf">
      <div class="profile">
        <img class="profile-ava" src="./asset/images.jpg" alt="">
        <h1 class="nameuser"></h1>
        <nav>
          <a href="/ad_user.html">Quản lý user</a>
          <a href="/ad_flower.html">Quản lý hoa</a>
          <a href="/ad_set.html">Quản lý Bộ</a>
          <a href="/ad_genus.html">Quản lý Chi</a>
          <a href="/ad_surname.html">Quản lý Họ</a>
          <a href="/ad_shape.html">Quản lý Hình dạng</a>
          <a href="/ad_surface.html">Quản lý Bề mặt</a>
          <a href="/ad_aperture.html">Quản lý Loại độ khẩu</a>
          <a href="/ad_part.html">Quản lý Phần</a>
        </nav>
      </div>
    </div>
    <div class="management_rg">
      <div >
        <div class="header">
          <button id="logoutButton">Đăng xuất</button>
          <!-- <div id="notification">Xóa dữ liệu thành công</div> -->
          <!-- <div id="notificationcr">Thêm dữ liệu thành công</div> -->
        </div>
        <div class="container mb-4 d-flex" style="justify-content: space-between;">
          <h1>Quản lý thông các tài khoản</h1>
          <div class="d-flex">
            <input type="text" id="searchInput" class="form-control" placeholder="Tìm kiếm tài khoản...">
            <button id="addFlowerBtn">Thêm mới</button>
          </div>
        </div>
      </div>

      <table id="flowerTable" class="table table-hover">
        <thead>
          <tr>
            <th>Tên</th>
            <th>Email</th>
            <th>Thời gian cập nhật</th>
            <th>Tính năng</th>
          </tr>
          </thead>
          <tbody id="tableRows">
            <!-- Các hàng dữ liệu sẽ được thêm vào đây bằng JavaScript -->
          </tbody>
      </table>
      <tbody id="tableRows">
        <!-- Các hàng dữ liệu sẽ được thêm vào đây bằng JavaScript -->
      </tbody>
      <div id="pagination"></div>



<script src="./js/menu_ad.js"></script>

<script src="./js/pagination.js"></script>
<script>
document.addEventListener('DOMContentLoaded', function() {
    const rowsPerPage = 9 // Số mục trên mỗi trang
    let currentPage = 1;
    let totalPages = 1;

    function processUserData(res, containerId) {
        const users = res.data.users;
        if (users && Array.isArray(users)) {
            let rows = '';
            users.forEach(user => {
                rows += `
                    <tr>
                        <td>${user.name}</td>
                        <td>${user.email}</td>
                        <td>${new Date(user.updated_at).toLocaleString()}</td>
                        <td>
                            <button class="btn btn-warning" onclick="editUser('${user._id}')"><i class="fa-solid fa-pen-to-square"></i></button>
                            <button class="btn btn-danger" onclick="deleteUser('${user._id}')"><i class="fa-solid fa-trash"></i></button>
                        </td>
                    </tr>
                `;
            });
            document.getElementById(containerId).innerHTML = rows;
            totalPages = Math.ceil(res.data.total / rowsPerPage);
            renderPagination(currentPage, totalPages, 'pagination', fetchUserData);
        } else {
            console.error('Invalid data format:', res);
        }
    }

    function fetchUserData(page) {
    currentPage = page; // Cập nhật currentPage với trang mới được chọn

        // Sử dụng page thay vì currentPage ở đây
        fetchDataAndDisplay('http://localhost:3456/users/', rowsPerPage, currentPage, 'tableRows', processUserData);
    }


    // Gọi hàm fetchUserData để hiển thị dữ liệu ban đầu
    fetchUserData(currentPage);
});
</script>
<script src="./js/logout.js"></script>
</body>
</html>